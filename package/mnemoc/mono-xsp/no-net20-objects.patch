--- ./configure.in	(revision 40359)
+++ ./configure.in	(working copy)
@@ -19,6 +19,25 @@
 	MCS=$CSC
 fi
 
+if test "x$GMCS" != "xno" ; then
+	AC_MSG_CHECKING([whether gmcs is actually able to compile])
+
+	tmpin=`mktemp /tmp/xsp.XXXXXX`
+	tmpout=`mktemp /tmp/xsp.XXXXXX`
+
+	echo "class Foo { public static void Main() {} }" > $tmpin
+
+	if [ gmcs -r:System.Web.dll -out:$tmpout $tmpin > /dev/null 2>&1 ]
+	then
+		AC_MSG_RESULT(yes)
+	else
+		GMCS=no
+		AC_MSG_RESULT(no)
+	fi
+
+	rm -f $tmpin $tmpout
+fi
+
 case "$host" in
 	*-*-mingw*|*-*-cygwin*)
 	platform_win32=yes	
--- ./configure.orig	2005-03-31 18:20:41.000000000 +0200
+++ ./configure	2005-03-31 18:20:47.000000000 +0200
@@ -1974,6 +1974,28 @@
 	MCS=$CSC
 fi
 
+if test "x$GMCS" != "xno" ; then
+	echo "$as_me:$LINENO: checking whether gmcs is actually able to compile" >&5
+echo $ECHO_N "checking whether gmcs is actually able to compile... $ECHO_C" >&6
+
+	tmpin=`mktemp /tmp/xsp.XXXXXX`
+	tmpout=`mktemp /tmp/xsp.XXXXXX`
+
+	echo "class Foo { public static void Main() {} }" > $tmpin
+
+	if  gmcs -r:System.Web.dll -out:$tmpout $tmpin > /dev/null 2>&1
+	then
+		echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
+	else
+		GMCS=no
+		echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+	fi
+
+	rm -f $tmpin $tmpout
+fi
+
 case "$host" in
 	*-*-mingw*|*-*-cygwin*)
 	platform_win32=yes
