#!/bin/bash

mount -t proc none /proc
mount -t tmpfs none /tmp
mount -t devfs none /dev
mount -t devpts none /dev/pts

cd /dev ; rm -f fd
ln -sf /proc/kcore      core
ln -sf /proc/self/fd    fd
ln -sf fd/0             stdin
ln -sf fd/1             stdout
ln -sf fd/2             stderr
ln -sf misc/psaux	mouse
cd /

exec < /dev/console > /dev/console 2> /dev/console ; cd /
export PATH="/sbin:/bin:/usr/sbin:/usr/bin"

for x in /etc/lvp/*.sh ; do
   if [ -f "${x}" ] ; then
      echo ; echo "Starting ${x##*/} ..." ; bash ${x} start
      echo "Setup script ${x##*/} finished."
   fi
done

/sbin/startlvp

for x in /etc/lvp/*.sh ; do
   if [ -f "${x}" ] ; then
      echo ; echo "Stopping ${x##*/} ..." ; bash ${x} stop
      echo "Setup script ${x##*/} finished."
   fi
done

umount /dev/pts
umount /dev
umount /proc
umount /tmp
